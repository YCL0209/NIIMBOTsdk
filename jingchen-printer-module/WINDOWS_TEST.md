# Windows 平台测试清单

> 精臣打印机 TypeScript 模块 - Windows 兼容性测试指南

## 📋 测试概述

本文档提供详细的 Windows 平台测试清单，帮助您验证模块在 Windows 环境中的功能完整性和兼容性。

**测试时间估计：** 30-45 分钟

---

## 🎯 测试环境要求

### 硬件要求
- [ ] Windows 10 或 Windows 11 PC
- [ ] 至少 4GB RAM
- [ ] 可用 USB 端口（用于 USB 打印机测试）
- [ ] WiFi 网络（用于 WiFi 打印机测试，可选）

### 软件要求
- [ ] Node.js v16+
- [ ] npm v7+
- [ ] 浏览器：Chrome/Edge/Firefox 最新版本
- [ ] 精臣打印服务已安装

### 测试设备
- [ ] 精臣标签打印机（B系列/K系列/M系列等）
- [ ] 标签纸（建议 40mm × 20mm）
- [ ] USB 数据线

---

## 📝 完整测试清单

### 阶段 1：环境准备测试 ✅

#### 1.1 Node.js 环境验证

```powershell
# 在 PowerShell 中运行
node --version
npm --version
```

**预期结果：**
```
v18.x.x (或更高)
9.x.x (或更高)
```

**测试结果：** ✅ / ❌
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 1.2 打印服务安装验证

```powershell
# 检查服务状态
Get-Service -Name "*jingchen*"
```

**预期结果：**
- Status: Running
- StartType: Automatic

**测试结果：** ✅ / ❌
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 1.3 端口监听验证

```powershell
# 检查端口 37989
netstat -ano | findstr :37989
Test-NetConnection -ComputerName 127.0.0.1 -Port 37989
```

**预期结果：**
- 端口 37989 处于 LISTENING 状态
- TcpTestSucceeded: True

**测试结果：** ✅ / ❌
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 1.4 防火墙规则验证

```powershell
# 检查防火墙规则
Get-NetFirewallRule -DisplayName "*精臣*"
```

**预期结果：**
- 至少有一条入站规则
- Enabled: True
- Action: Allow

**测试结果：** ✅ / ❌
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

### 阶段 2：项目安装测试 📦

#### 2.1 依赖安装测试

```powershell
cd path\to\jingchen-printer-module
npm install
```

**测试检查点：**
- [ ] 安装过程无错误
- [ ] 生成 `node_modules` 目录
- [ ] 生成 `package-lock.json` 文件
- [ ] 显示 "added 350 packages" 或类似信息

**安装耗时：** \_\_\_\_ 秒
**测试结果：** ✅ / ❌
**错误信息（如有）：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 2.2 TypeScript 编译测试

```powershell
npm run build
```

**测试检查点：**
- [ ] 编译过程无错误
- [ ] 生成 `dist` 目录
- [ ] dist 目录包含 .js、.d.ts、.js.map 文件
- [ ] 文件数量：约 15+ 个文件

**编译耗时：** \_\_\_\_ 秒
**测试结果：** ✅ / ❌
**错误信息（如有）：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 2.3 开发服务器启动测试

```powershell
npm run test
```

**测试检查点：**
- [ ] Webpack 编译成功
- [ ] 服务器启动在 http://localhost:8080
- [ ] 浏览器自动打开测试页面
- [ ] 页面无 JavaScript 错误

**启动耗时：** \_\_\_\_ 秒
**测试结果：** ✅ / ❌
**错误信息（如有）：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

### 阶段 3：浏览器兼容性测试 🌐

#### 3.1 Microsoft Edge 测试

**浏览器版本：** \_\_\_\_\_\_\_\_\_\_

测试步骤：
1. [ ] 打开 http://localhost:8080
2. [ ] 页面正常加载，无错误
3. [ ] F12 打开开发者工具，控制台无错误
4. [ ] 点击"连接打印服务"
5. [ ] 显示"服务已连接"状态

**测试结果：** ✅ / ❌
**控制台错误（如有）：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 3.2 Google Chrome 测试

**浏览器版本：** \_\_\_\_\_\_\_\_\_\_

测试步骤：
1. [ ] 打开 http://localhost:8080
2. [ ] 页面正常加载，无错误
3. [ ] F12 打开开发者工具，控制台无错误
4. [ ] 点击"连接打印服务"
5. [ ] 显示"服务已连接"状态

**测试结果：** ✅ / ❌
**控制台错误（如有）：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 3.3 Firefox 测试（可选）

**浏览器版本：** \_\_\_\_\_\_\_\_\_\_

测试步骤：
1. [ ] 打开 http://localhost:8080
2. [ ] 页面正常加载，无错误
3. [ ] F12 打开开发者工具，控制台无错误
4. [ ] 点击"连接打印服务"
5. [ ] 显示"服务已连接"状态

**测试结果：** ✅ / ❌
**控制台错误（如有）：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

### 阶段 4：WebSocket 连接测试 🔌

#### 4.1 服务连接测试

在测试页面中：
1. [ ] 点击"连接打印服务"按钮
2. [ ] 观察状态指示器变为绿色"服务已连接"
3. [ ] 日志中显示"打印服务连接成功!"

**测试结果：** ✅ / ❌
**连接耗时：** \_\_\_\_ 毫秒
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 4.2 WebSocket 网络检查

在浏览器开发者工具中：
1. [ ] 打开"网络"选项卡
2. [ ] 筛选器选择"WS"（WebSocket）
3. [ ] 刷新页面并连接服务
4. [ ] 看到 `ws://127.0.0.1:37989` 连接
5. [ ] 连接状态为"101 Switching Protocols"

**测试结果：** ✅ / ❌
**WebSocket 帧数：** \_\_\_\_
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 4.3 自动重连测试

测试步骤：
1. [ ] 连接打印服务
2. [ ] 停止精臣打印服务（`Stop-Service`）
3. [ ] 观察页面显示"服务未连接"
4. [ ] 重新启动打印服务（`Start-Service`）
5. [ ] 观察页面自动重连（约 3 秒后）

**测试结果：** ✅ / ❌
**重连耗时：** \_\_\_\_ 秒
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

### 阶段 5：SDK 初始化测试 ⚙️

#### 5.1 SDK 初始化

测试步骤：
1. [ ] 确保打印服务已连接
2. [ ] 点击"初始化SDK"按钮
3. [ ] 日志显示"正在初始化SDK..."
4. [ ] 日志显示"SDK 初始化成功!"

**测试结果：** ✅ / ❌
**初始化耗时：** \_\_\_\_ 毫秒
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

### 阶段 6：打印机扫描测试 🔍

#### 6.1 USB 打印机扫描

**打印机型号：** \_\_\_\_\_\_\_\_\_\_
**连接方式：** USB

测试步骤：
1. [ ] 确保打印机通过 USB 连接到 PC
2. [ ] 打印机已开机
3. [ ] Windows 已识别打印机（设备管理器中可见）
4. [ ] 点击"扫描USB打印机"按钮
5. [ ] 等待扫描完成（约 2-5 秒）
6. [ ] 日志显示"找到 X 台USB打印机"
7. [ ] 打印机列表中显示打印机名称和端口

**测试结果：** ✅ / ❌
**找到打印机数量：** \_\_\_\_
**打印机名称：** \_\_\_\_\_\_\_\_\_\_
**端口号：** \_\_\_\_\_\_\_\_\_\_
**扫描耗时：** \_\_\_\_ 秒
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 6.2 WiFi 打印机扫描（可选）

**打印机型号：** \_\_\_\_\_\_\_\_\_\_
**连接方式：** WiFi
**打印机 IP：** \_\_\_\_\_\_\_\_\_\_

测试步骤：
1. [ ] 确保打印机已连接到 WiFi
2. [ ] 打印机和 PC 在同一局域网
3. [ ] 点击"扫描WiFi打印机"按钮
4. [ ] 等待扫描完成（约 20-25 秒）
5. [ ] 日志显示"找到 X 台WiFi打印机"
6. [ ] 打印机列表中显示打印机信息

**测试结果：** ✅ / ❌
**找到打印机数量：** \_\_\_\_
**扫描耗时：** \_\_\_\_ 秒
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

### 阶段 7：打印机连接测试 🔗

#### 7.1 连接打印机

测试步骤：
1. [ ] 在打印机列表中找到目标打印机
2. [ ] 点击"连接"按钮
3. [ ] 日志显示"正在连接打印机..."
4. [ ] 日志显示"打印机连接成功"
5. [ ] 状态指示器显示"打印机已连接"

**测试结果：** ✅ / ❌
**连接耗时：** \_\_\_\_ 毫秒
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

### 阶段 8：条码打印功能测试 🖨️

#### 8.1 CODE128 条码打印

测试步骤：
1. [ ] 条码类型选择"CODE128"
2. [ ] 条码内容输入"12345678"
3. [ ] 标签宽度：40mm
4. [ ] 标签高度：20mm
5. [ ] 点击"打印条码"按钮
6. [ ] 日志显示"正在打印条码..."
7. [ ] 日志显示"条码打印成功!"
8. [ ] 打印机输出标签

**测试结果：** ✅ / ❌
**打印耗时：** \_\_\_\_ 秒
**标签质量：** ✅ 清晰 / ❌ 模糊
**条码可扫描：** ✅ / ❌
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 8.2 EAN13 条码打印

测试步骤：
1. [ ] 条码类型选择"EAN13"
2. [ ] 条码内容输入"6901234567892"（13位数字）
3. [ ] 标签宽度：40mm
4. [ ] 标签高度：20mm
5. [ ] 点击"打印条码"按钮
6. [ ] 打印成功

**测试结果：** ✅ / ❌
**标签质量：** ✅ 清晰 / ❌ 模糊
**条码可扫描：** ✅ / ❌
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 8.3 条码预览功能

测试步骤：
1. [ ] 设置条码参数
2. [ ] 点击"预览条码"按钮
3. [ ] 预览区域显示条码图片
4. [ ] 图片清晰可见
5. [ ] 条码内容正确

**测试结果：** ✅ / ❌
**预览生成耗时：** \_\_\_\_ 毫秒
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 8.4 快速打印示例

测试步骤：
1. [ ] 点击"快速打印 CODE128"
2. [ ] 打印内容"DEMO-12345"
3. [ ] 打印成功

**测试结果：** ✅ / ❌

---

1. [ ] 点击"快速打印 EAN13"
2. [ ] 打印内容"6901234567892"
3. [ ] 打印成功

**测试结果：** ✅ / ❌

---

#### 8.5 批量打印测试

测试步骤：
1. [ ] 点击"批量打印测试"
2. [ ] 打印 3 个条码（BATCH-001, BATCH-002, BATCH-003）
3. [ ] 所有条码打印成功
4. [ ] 打印顺序正确

**测试结果：** ✅ / ❌
**总耗时：** \_\_\_\_ 秒
**平均每个：** \_\_\_\_ 秒
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

### 阶段 9：错误处理测试 ⚠️

#### 9.1 内容验证测试

测试步骤：
1. [ ] 选择 EAN13 类型
2. [ ] 输入无效内容"12345"（不足13位）
3. [ ] 点击打印
4. [ ] 日志显示错误："EAN13 条码必须是 13 位"

**测试结果：** ✅ / ❌
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 9.2 断开连接测试

测试步骤：
1. [ ] 已连接打印服务和打印机
2. [ ] 点击"断开打印服务"
3. [ ] 状态变为"服务未连接"和"打印机未连接"
4. [ ] 尝试打印条码
5. [ ] 显示错误："打印服务未连接"

**测试结果：** ✅ / ❌
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

### 阶段 10：性能测试 ⚡

#### 10.1 连接速度测试

测试项目：
- 连接打印服务：\_\_\_\_ ms
- 初始化 SDK：\_\_\_\_ ms
- 扫描 USB 打印机：\_\_\_\_ ms
- 连接打印机：\_\_\_\_ ms

**整体耗时：** \_\_\_\_ ms
**测试结果：** ✅ 良好（<5秒）/ ⚠️ 一般（5-10秒）/ ❌ 较慢（>10秒）

---

#### 10.2 打印速度测试

测试项目：
- 单个条码打印：\_\_\_\_ 秒
- 批量 3 个条码：\_\_\_\_ 秒
- 批量 10 个条码：\_\_\_\_ 秒（可选）

**平均单个打印：** \_\_\_\_ 秒
**测试结果：** ✅ 良好（<3秒）/ ⚠️ 一般（3-5秒）/ ❌ 较慢（>5秒）

---

#### 10.3 内存使用测试

测试步骤：
1. [ ] 打开任务管理器
2. [ ] 查看浏览器进程内存使用
3. [ ] 打印 20 个条码
4. [ ] 观察内存增长情况

**初始内存：** \_\_\_\_ MB
**打印后内存：** \_\_\_\_ MB
**内存增长：** \_\_\_\_ MB
**测试结果：** ✅ 稳定（<50MB增长）/ ⚠️ 一般（50-100MB）/ ❌ 内存泄漏（>100MB）

---

### 阶段 11：兼容性特殊测试 🔧

#### 11.1 中文路径测试

测试步骤：
1. [ ] 将项目复制到包含中文的路径（如 `C:\用户\测试\打印机模块`）
2. [ ] 运行 `npm install`
3. [ ] 运行 `npm run build`
4. [ ] 运行 `npm run test`
5. [ ] 所有功能正常

**测试路径：** \_\_\_\_\_\_\_\_\_\_
**测试结果：** ✅ / ❌
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 11.2 长路径测试

测试步骤：
1. [ ] 将项目复制到深层路径（如 `C:\a\b\c\d\e\f\g\...`）
2. [ ] 运行基本命令
3. [ ] 所有功能正常

**路径深度：** \_\_\_\_ 层
**测试结果：** ✅ / ❌
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

#### 11.3 权限测试

测试步骤：
1. [ ] 以普通用户（非管理员）身份运行
2. [ ] npm install 成功
3. [ ] npm run build 成功
4. [ ] 连接打印服务成功

**测试用户：** \_\_\_\_\_\_\_\_\_\_
**测试结果：** ✅ / ❌
**备注：** \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

## 📊 测试结果汇总

### 通过率统计

| 测试阶段 | 通过项 | 总项数 | 通过率 |
|---------|-------|--------|--------|
| 环境准备 | \_\_\_ / 4 | 4 | \_\_\_% |
| 项目安装 | \_\_\_ / 3 | 3 | \_\_\_% |
| 浏览器兼容性 | \_\_\_ / 3 | 3 | \_\_\_% |
| WebSocket 连接 | \_\_\_ / 3 | 3 | \_\_\_% |
| SDK 初始化 | \_\_\_ / 1 | 1 | \_\_\_% |
| 打印机扫描 | \_\_\_ / 2 | 2 | \_\_\_% |
| 打印机连接 | \_\_\_ / 1 | 1 | \_\_\_% |
| 条码打印功能 | \_\_\_ / 5 | 5 | \_\_\_% |
| 错误处理 | \_\_\_ / 2 | 2 | \_\_\_% |
| 性能测试 | \_\_\_ / 3 | 3 | \_\_\_% |
| 兼容性特殊测试 | \_\_\_ / 3 | 3 | \_\_\_% |
| **总计** | **\_\_\_ / 30** | **30** | **\_\_\_%** |

### 最终结论

**测试日期：** \_\_\_\_\_\_\_\_\_\_
**测试人员：** \_\_\_\_\_\_\_\_\_\_
**Windows 版本：** \_\_\_\_\_\_\_\_\_\_
**Node.js 版本：** \_\_\_\_\_\_\_\_\_\_
**浏览器版本：** \_\_\_\_\_\_\_\_\_\_

**整体评估：**
- ✅ 完全兼容（通过率 ≥ 90%）
- ⚠️ 基本兼容（通过率 70-89%）
- ❌ 不兼容（通过率 < 70%）

**主要问题：**
1. \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
2. \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
3. \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

**建议改进：**
1. \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
2. \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
3. \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

## 📤 提交测试报告

请将填写完整的测试清单发送至：
- GitHub Issues
- 项目维护者邮箱
- 技术支持渠道

附件请包括：
- 本测试清单（填写完整）
- 错误截图（如有）
- 浏览器控制台日志（如有错误）
- Windows 系统信息（`winver` 截图）

---

**感谢您的测试！** 🎉

您的反馈对改进跨平台兼容性至关重要！
